<div class="min-h-screen bg-slate-50">
  <!-- Header -->
  <header class="bg-white border-b border-slate-200 sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
      <a href="/" class="flex items-center gap-2 text-xl font-bold text-slate-900">
        <span class="w-9 h-9 bg-emerald-500 rounded-lg flex items-center justify-center text-white font-bold">G</span>
        GuardRail
      </a>
      <div class="flex items-center gap-4">
        <%= link_to 'Upload Document', new_document_path, class: 'bg-emerald-500 hover:bg-emerald-600 text-white px-5 py-2.5 rounded-lg font-semibold transition-all' %>
        <div class="relative">
          <span class="text-slate-600"><%= current_user.full_name %></span>
        </div>
        <%= link_to 'Sign Out', destroy_user_session_path, data: { turbo_method: :delete }, class: 'text-slate-500 hover:text-slate-700' %>
      </div>
    </div>
  </header>

  <div class="max-w-7xl mx-auto px-6 py-8">
    <h1 class="text-2xl font-bold text-slate-900 mb-8">Dashboard</h1>

    <!-- Top Row: Health Score + Stats -->
    <div class="grid lg:grid-cols-3 gap-6 mb-8">
      <!-- Health Score Card -->
      <div class="bg-white rounded-2xl border border-slate-200 p-6 flex items-center gap-6">
        <div class="relative w-24 h-24">
          <svg class="w-24 h-24 transform -rotate-90">
            <circle cx="48" cy="48" r="40" stroke="#E2E8F0" stroke-width="8" fill="none"/>
            <circle cx="48" cy="48" r="40" 
              stroke="<%= @health_score >= 80 ? '#10B981' : @health_score >= 50 ? '#F59E0B' : '#EF4444' %>" 
              stroke-width="8" fill="none"
              stroke-dasharray="251.2"
              stroke-dashoffset="<%= 251.2 * (1 - @health_score / 100.0) %>"
              stroke-linecap="round"/>
          </svg>
          <span class="absolute inset-0 flex items-center justify-center text-2xl font-bold text-slate-900">
            <%= @health_score %>
          </span>
        </div>
        <div>
          <div class="font-semibold text-slate-900">Compliance Score</div>
          <div class="text-sm text-<%= @health_score >= 80 ? 'emerald' : @health_score >= 50 ? 'amber' : 'red' %>-500">
            <%= @health_score >= 80 ? 'Good Standing' : @health_score >= 50 ? 'Needs Attention' : 'Action Required' %>
          </div>
        </div>
      </div>

      <!-- Stats Grid -->
      <div class="lg:col-span-2 grid grid-cols-2 sm:grid-cols-4 gap-4">
        <div class="bg-white rounded-xl border border-slate-200 p-4">
          <div class="text-2xl mb-1">üìÑ</div>
          <div class="text-2xl font-bold text-slate-900"><%= @total_documents %></div>
          <div class="text-sm text-slate-500">Total Documents</div>
        </div>
        <div class="bg-amber-50 rounded-xl border border-amber-200 p-4">
          <div class="text-2xl mb-1">‚ö†Ô∏è</div>
          <div class="text-2xl font-bold text-amber-600"><%= @expiring_soon_count %></div>
          <div class="text-sm text-amber-600">Expiring Soon</div>
        </div>
        <div class="bg-red-50 rounded-xl border border-red-200 p-4">
          <div class="text-2xl mb-1">üî¥</div>
          <div class="text-2xl font-bold text-red-600"><%= @expired_count %></div>
          <div class="text-sm text-red-600">Expired</div>
        </div>
        <div class="bg-white rounded-xl border border-slate-200 p-4">
          <div class="text-2xl mb-1">üë•</div>
          <div class="text-2xl font-bold text-slate-900"><%= @team_count %></div>
          <div class="text-sm text-slate-500">Team Members</div>
        </div>
      </div>
    </div>

    <!-- Urgent Items -->
    <div class="bg-white rounded-2xl border border-slate-200 p-6 mb-8">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-lg font-semibold text-slate-900">üî∫ Next 30 Days - Urgent Items</h2>
        <%= link_to 'View All', documents_path(status: 'expiring'), class: 'text-emerald-600 hover:text-emerald-700 font-medium text-sm' %>
      </div>
      
      <% if @urgent_documents.any? %>
        <div class="divide-y divide-slate-100">
          <% @urgent_documents.each do |doc| %>
            <div class="py-3 flex justify-between items-center">
              <div class="flex items-center gap-3">
                <span class="w-8 h-8 rounded-full flex items-center justify-center text-sm
                  <%= doc.days_until_expiry <= 7 ? 'bg-red-100 text-red-600' : 'bg-amber-100 text-amber-600' %>">
                  <%= doc.days_until_expiry <= 7 ? 'üî¥' : '‚ö†Ô∏è' %>
                </span>
                <%= link_to doc.name, document_path(doc), class: 'font-medium text-slate-900 hover:text-emerald-600' %>
              </div>
              <div class="flex items-center gap-4 text-sm">
                <span class="text-slate-500">Expires: <%= doc.expiration_date.strftime('%b %d, %Y') %></span>
                <span class="font-semibold <%= doc.days_until_expiry <= 7 ? 'text-red-600' : 'text-amber-600' %>">
                  <%= doc.days_until_expiry %> days
                </span>
              </div>
            </div>
          <% end %>
        </div>
      <% else %>
        <div class="text-center py-8">
          <span class="text-4xl">üéâ</span>
          <p class="text-slate-500 mt-2">No urgent items! All documents are compliant.</p>
        </div>
      <% end %>
    </div>

    <!-- Recent Activity -->
    <div class="bg-white rounded-2xl border border-slate-200 p-6">
      <h2 class="text-lg font-semibold text-slate-900 mb-4">Recent Activity</h2>
      <div class="divide-y divide-slate-100">
        <% @recent_activity.each do |log| %>
          <div class="py-3 flex justify-between items-center text-sm">
            <span class="text-slate-900"><%= log.action.humanize %></span>
            <span class="text-slate-500"><%= log.user&.full_name || 'System' %></span>
            <span class="text-slate-400"><%= time_ago_in_words(log.created_at) %> ago</span>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
